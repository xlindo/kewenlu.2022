<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>时频分析——短时傅里叶变换STFT - 科文路</title><link rel="manifest" href="/kewenlu2022/manifest.json"><meta name="application-name" content="科文路2022"><meta name="msapplication-TileImage" content="/images/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="科文路2022"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="文章来自微信公众号“科文路”，欢迎关注、互动。转发须注明出处。 短时傅里叶变换STFT，在语音识别中有重要应用，这是一篇讲 STFT 的好文。   版权声明：本文为博主原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接和本声明。 本文链接：时频分析之STFT：短时傅里叶变换的原理与代码实现（非调用Matlab API）"><meta property="og:type" content="blog"><meta property="og:title" content="时频分析——短时傅里叶变换STFT"><meta property="og:url" content="https://xlindo.com/kewenlu2022/posts/64460339/"><meta property="og:site_name" content="科文路"><meta property="og:description" content="文章来自微信公众号“科文路”，欢迎关注、互动。转发须注明出处。 短时傅里叶变换STFT，在语音识别中有重要应用，这是一篇讲 STFT 的好文。   版权声明：本文为博主原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接和本声明。 本文链接：时频分析之STFT：短时傅里叶变换的原理与代码实现（非调用Matlab API）"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/202204061.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/202204062.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/202204063.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/202204064.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/202204065.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/202204066.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/202204067.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/202204068.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/202204069.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/2022040610.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/2022040611.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/2022040612.png"><meta property="og:image" content="https://xlindo.com/kewenlu2022/images/2022/2022040613.png"><meta property="article:published_time" content="2022-04-06T12:02:29.000Z"><meta property="article:modified_time" content="2023-05-10T03:19:18.603Z"><meta property="article:author" content="xlindo"><meta property="article:tag" content="科技"><meta property="article:tag" content="备查手册"><meta property="article:tag" content="时频分析"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://xlindo.com/kewenlu2022/images/2022/202204061.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://xlindo.com/kewenlu2022/posts/64460339/"},"headline":"时频分析——短时傅里叶变换STFT","image":["https://xlindo.com/kewenlu2022/images/2022/202204061.png","https://xlindo.com/kewenlu2022/images/2022/202204062.png","https://xlindo.com/kewenlu2022/images/2022/202204063.png","https://xlindo.com/kewenlu2022/images/2022/202204064.png","https://xlindo.com/kewenlu2022/images/2022/202204065.png","https://xlindo.com/kewenlu2022/images/2022/202204066.png","https://xlindo.com/kewenlu2022/images/2022/202204067.png","https://xlindo.com/kewenlu2022/images/2022/202204068.png","https://xlindo.com/kewenlu2022/images/2022/202204069.png","https://xlindo.com/kewenlu2022/images/2022/2022040610.png","https://xlindo.com/kewenlu2022/images/2022/2022040611.png","https://xlindo.com/kewenlu2022/images/2022/2022040612.png","https://xlindo.com/kewenlu2022/images/2022/2022040613.png"],"datePublished":"2022-04-06T12:02:29.000Z","dateModified":"2023-05-10T03:19:18.603Z","author":{"@type":"Person","name":"xlindo"},"publisher":{"@type":"Organization","name":"科文路","logo":{"@type":"ImageObject","url":"https://xlindo.com/images/favicon.ico"}},"description":"文章来自微信公众号“科文路”，欢迎关注、互动。转发须注明出处。 短时傅里叶变换STFT，在语音识别中有重要应用，这是一篇讲 STFT 的好文。   版权声明：本文为博主原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接和本声明。 本文链接：时频分析之STFT：短时傅里叶变换的原理与代码实现（非调用Matlab API）"}</script><link rel="canonical" href="https://xlindo.com/kewenlu2022/posts/64460339/"><link rel="icon" href="/kewenlu2022/images/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/kewenlu2022/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><meta name="msvalidate.01" content="043B69617A5E44A2F7CD99A00708FFF3"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/kewenlu2022/"><img src="/kewenlu2022/images/favicon.ico" alt="科文路" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/kewenlu2022/">Home</a><a class="navbar-item" href="/kewenlu2022/archives">Archives</a><a class="navbar-item" href="/kewenlu2022/tags">Tags</a><a class="navbar-item" href="/kewenlu2022/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-04-06T12:02:29.000Z" title="4/6/2022, 8:02:29 PM">2022-04-06</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-05-10T03:19:18.603Z" title="5/10/2023, 11:19:18 AM">2023-05-10</time></span><span class="level-item"><a class="link-muted" href="/kewenlu2022/categories/%E7%A7%91%E6%8A%80/">科技</a></span><span class="level-item">23 minutes read (About 3481 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">时频分析——短时傅里叶变换STFT</h1><div class="content"><blockquote>
<p>文章来自微信公众号“科文路”，欢迎关注、互动。转发须注明出处。</p>
<p>短时傅里叶变换STFT，在语音识别中有重要应用，这是一篇讲 STFT 的好文。</p>
</blockquote>
<blockquote>
<p>版权声明：本文为博主原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接和本声明。</p>
<p>本文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/frostime/article/details/106816373" title="时频分析之STFT：短时傅里叶变换的原理与代码实现（非调用Matlab API）">时频分析之STFT：短时傅里叶变换的原理与代码实现（非调用Matlab API）</a></p>
</blockquote>
<span id="more"></span>

<h1 id="1-引言"><a href="#1-引言" class="headerlink" title="1. 引言"></a>1. 引言</h1><p>在信号分析中，傅里叶变换可称得上是神器。但在实际应用中，人们发现它还是存在一些不可忽视的缺陷。</p>
<p>为了便于叙述考察以下两种情形：</p>
<h2 id="Case-1"><a href="#Case-1" class="headerlink" title="Case 1"></a>Case 1</h2><p>考察这样一个函数：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fs = <span class="number">1000</span>;</span><br><span class="line">t = <span class="number">0</span>:<span class="number">1</span>/fs:<span class="number">1</span> - <span class="number">1</span>/fs;</span><br><span class="line">x = [<span class="number">10</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">10</span> * t), <span class="number">20</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">20</span> * t),...</span><br><span class="line">        <span class="number">30</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">30</span> * t), <span class="number">40</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">40</span> * t)];</span><br></pre></td></tr></table></figure>

<p>绘制这个函数的时域图像和经过傅立叶变换后的频谱图像，长这个样子：</p>
<p><img src="/kewenlu2022/images/2022/202204061.png" alt="spectrogram"></p>
<p>现在把信号反转过来：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = [10 * cos(2 * pi * 10 * t), 20 * cos(2 * pi * 20 * t),...</span><br><span class="line">        30 * cos(2 * pi * 30 * t), 40 * cos(2 * pi * 40 * t)];</span><br><span class="line">x = x(end:-1:1);</span><br></pre></td></tr></table></figure>

<p>再次绘制时域和频域的图像，它长这样：</p>
<p><img src="/kewenlu2022/images/2022/202204062.png" alt="spectrogram"></p>
<p>不难发现，尽管<strong>这两个信号的时域分布完全相反，但是它们的频谱图是完全一致的</strong>。显然，FFT 无法捕捉到信号在时域分布上的不同。</p>
<h2 id="Case-2"><a href="#Case-2" class="headerlink" title="Case 2"></a>Case 2</h2><p>考察一个普普通通的信号:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fs = 1000;</span><br><span class="line">t = 0:1/fs:1-1/fs;</span><br><span class="line"></span><br><span class="line">x = 2 * cos(2 * 10 * t) + 4 * sin(2 * 30 * t);</span><br></pre></td></tr></table></figure>

<p>同样绘制它的时域以及频域图像：  </p>
<p><img src="/kewenlu2022/images/2022/202204063.png" alt="spectrogram"></p>
<p>现在给信号加入一个高频突变：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sharp = zeros(1, length(x));</span><br><span class="line">% 给信号中间加一个突变</span><br><span class="line">sharp(501:510) = 5 * cos(2 * pi * 100 * linspace(0, 1, 10));</span><br><span class="line">x = x + sharp;</span><br></pre></td></tr></table></figure>

<p>然后绘图：  </p>
<p><img src="/kewenlu2022/images/2022/202204064.png" alt="spectrogram"></p>
<p>对比两个信号的时域图，我们能很明显发现在第二个信号中央的部分出现了一个突变扰动。然而在频域图中，这样的变化并没有很好的被捕捉到。注意到红框中部分，显然<strong>傅里叶变换把突变解释为了一系列低成分的高频信号的叠加，并没有很好的反应突变扰动给信号带来的变化</strong>。</p>
<h2 id="为什么我们需要时频分析"><a href="#为什么我们需要时频分析" class="headerlink" title="为什么我们需要时频分析"></a>为什么我们需要时频分析</h2><p>通过以上的两个例子，我们不难发现傅立叶变换的缺陷。</p>
<p>第一个例子告诉我们，傅里叶变换只能获取一段信号总体上包含哪些频率的成分，但是对各成分出现的时刻并无所知。因此时域相差很大的两个信号，可能频谱图一样。</p>
<p>第二个例子告诉我们，对于信号中的突变，傅里叶变换很难及时捕捉。而在有些场合，这样的突变往往是十分重要的。</p>
<p>当然如果非要硬杠，也不是完全没办法——这就需要需分析相位谱了，但在实际应用中，有谁会不嫌麻烦地去看相位谱呢？</p>
<p>总而言之，傅里叶变换非常擅长分析那些频率特征均一稳定的平稳信号。但是对于非平稳信号，傅立叶变换只能告诉我们信号当中有哪些频率成分——而这对我们来讲显然是不够的。我们还想知道各个成分出现的时间。知道信号频率随时间变化的情况，各个时刻的瞬时频率及其幅值——这也就是时频分析（<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/22450818" title="引用自知乎">引用自知乎</a>）。</p>
<p>所谓时频分析，就是既要考虑到频率特征，又要考虑到时间序列变化。常用的有两种方法：短时傅里叶变化，以及小波变换。本文我们只介绍短时傅里叶变换</p>
<h1 id="2-短时傅里叶变换原理"><a href="#2-短时傅里叶变换原理" class="headerlink" title="2. 短时傅里叶变换原理"></a>2. 短时傅里叶变换原理</h1><p>短时傅里叶变换的思路非常直观：既然对整个序列做 FFT 会丢失时间信息，那我一段一段地做 FFT 不就行了嘛！这也正是短时傅里叶变换名称的来源，Short Time Fourier Transorm，这里的 Short Time 就是指对一小段序列做 FFT。</p>
<p>那么怎么一段一段处理呢？直接截取信号的一段来做 FFT 吗？一般我们通过加窗的方法来截取信号的片段。定义一个窗函数 $w (t)$，比如这样。</p>
<p><img src="/kewenlu2022/images/2022/202204065.png" alt="window function">  </p>
<p>将窗函数位移到某一中心点 $\tau$，再将窗函数和原始信号相乘就可以得到截取后的信号 $y(t)$。</p>
<p>$$<br>y(t) &#x3D; x(t) \cdot \textrm{w}(t - \tau)<br>$$<br>前面提到的直接截取的方法其实就是对信号加一个矩形窗，不过一般我们很少选用矩形窗，因为矩形窗简单粗暴的截断方法会产生的频谱泄露以及<a target="_blank" rel="noopener" href="https://www.cnblogs.com/smallqing/p/10221784.html" title="吉布斯现象">吉布斯现象</a>，不利于频谱分析。更多关于窗函数的内容，可以看这里：<a target="_blank" rel="noopener" href="https://ww2.mathworks.cn/help/signal/ug/windows.html" title="加窗法">加窗法</a>。</p>
<p>对原始信号 $x(t)$ 做 STFT 的步骤如下。</p>
<p>首先将将窗口移动到信号的开端位置，此时窗函数的中心位置在 $t &#x3D; \tau_0$ 处，对信号加窗处理</p>
<p>$$<br>y(t) &#x3D; x(t) \cdot \textrm{w}(t - \tau_0)<br>$$</p>
<p>然后进行傅里叶变换</p>
<p>$$<br>X(\omega) &#x3D; \mathcal{F}(y(t)) &#x3D; \int_{\infty}^{+\infty}x(t)\cdot \textrm{w}(t-\tau_0) e^{-j\omega t}dt<br>$$</p>
<p>由此得到第一个分段序列的频谱分布 $X(\omega)$。在现实应用中，由于信号是离散的点序列，所以我们得到的是频谱序列 $X[N]$。</p>
<p>为了便于表示，我们在这里定义函数 $S(\omega, \tau)$，它表示，在窗函数中心为 $\tau$ 时，对原函数进行变换后的频谱结果 $X(\omega)$，即：</p>
<p>$$<br>S(\omega, \tau) &#x3D; \mathcal{F}(x(t)\cdot \textrm{w}(t-\tau)) &#x3D; \int_{\infty}^{+\infty}x(t)\cdot \textrm{w}(t-\tau) e^{-j\omega t}dt<br>$$</p>
<p>对应到离散场景中， $S[\omega, \tau]$ 就是一个二维矩阵，<strong>每一列代表了在不同位置对信号加窗，对得到的分段进行傅里叶变换后的结果序列</strong>。  </p>
<p><img src="/kewenlu2022/images/2022/202204066.png" alt="window"></p>
<p>完成了对第一个分段的 FFT 操作后，移动窗函数到 $\tau_1$。把窗体移动的距离称为 Hop Size。移动距离一般小于窗口的宽度，从而保证前后两个窗口之间存在一定重叠部分，我们管这个重叠叫 Overlap。</p>
<p><img src="/kewenlu2022/images/2022/202204067.png" alt="overlap"> </p>
<p>重复以上操作，不断滑动窗口、FFT，最终得到从 $\tau_0 \sim \tau_N$ 上所有分段的频谱结果：</p>
<p><img src="/kewenlu2022/images/2022/202204068.png" alt="sliding">  </p>
<p>最终我们得到的 $S$，就是 STFT 变换后的结果。</p>
<h1 id="3-STFT-实现"><a href="#3-STFT-实现" class="headerlink" title="3. STFT 实现"></a>3. STFT 实现</h1><p>以下代码基于 Matlab 2019b。</p>
<h2 id="3-1-算法实现"><a href="#3-1-算法实现" class="headerlink" title="3.1 算法实现"></a>3.1 算法实现</h2><p>STFT 的实现如下，算法返回的三个参数：</p>
<ul>
<li>f: m 维向量，表示傅里叶变换后每个点对应的频率值，单位为 Hz</li>
<li>t: n 维向量，表示 n 个窗口中心时间 $\tau_1 \sim \tau_n$，单位为秒</li>
<li>STFT: 一个二维矩阵 $[m, n]$，每个列向量代表了在对应 $\tau$ 上 FFT 变换的结果</li>
</ul>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[STFT, f, t]</span> = <span class="title">mystft</span><span class="params">(x, win, hop, nfft, fs)</span></span></span><br><span class="line">	<span class="comment">% 计算短时傅里叶变换</span></span><br><span class="line">    <span class="comment">% Input:</span></span><br><span class="line">    <span class="comment">%   x - 一维信号</span></span><br><span class="line">    <span class="comment">%   win - 窗函数</span></span><br><span class="line">    <span class="comment">%   hop - hop size，移动长度</span></span><br><span class="line">    <span class="comment">%   nfft - FFT points</span></span><br><span class="line">    <span class="comment">%   fs - 采样率</span></span><br><span class="line">    <span class="comment">%</span></span><br><span class="line">    <span class="comment">% Output:</span></span><br><span class="line">    <span class="comment">%   STFT - STFT-矩阵 [T, F]</span></span><br><span class="line">    <span class="comment">%   f - 频率向量</span></span><br><span class="line">    <span class="comment">%   t - 时间向量</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">% 把 x 变为列向量</span></span><br><span class="line">    x = x(:);</span><br><span class="line">    xlen = <span class="built_in">length</span>(x);</span><br><span class="line">    wlen = <span class="built_in">length</span>(win);</span><br><span class="line"></span><br><span class="line">    <span class="comment">% 窗口数目 L</span></span><br><span class="line">    L = <span class="number">1</span>+<span class="built_in">fix</span>((xlen-wlen)/hop);</span><br><span class="line">    STFT = <span class="built_in">zeros</span>(nfft, L);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">% STFT</span></span><br><span class="line">    <span class="keyword">for</span> l = <span class="number">0</span>:L<span class="number">-1</span></span><br><span class="line">        <span class="comment">% 加窗</span></span><br><span class="line">        xw = x(<span class="number">1</span>+l*hop : wlen+l*hop).*win;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% FFT计算</span></span><br><span class="line">        X = fft(xw, nfft);</span><br><span class="line">        X = fftshift(X);</span><br><span class="line"></span><br><span class="line">        STFT(:, <span class="number">1</span>+l) = X(<span class="number">1</span>:nfft);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">% 取每个窗口中点的时间点</span></span><br><span class="line">    t = (wlen/<span class="number">2</span>:hop:wlen/<span class="number">2</span>+(L<span class="number">-1</span>)*hop)/fs;</span><br><span class="line">    <span class="comment">%f = (0:nfft-1)*fs/nfft;</span></span><br><span class="line">    <span class="comment">% 频率 (fftshift之后的)</span></span><br><span class="line">    f = (-nfft/<span class="number">2</span>:nfft/<span class="number">2</span><span class="number">-1</span>) * (fs/nfft);</span><br><span class="line">    </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h2 id="3-2-使用范例"><a href="#3-2-使用范例" class="headerlink" title="3.2 使用范例"></a>3.2 使用范例</h2><p>我们这里使用 Case 1 的范例来看看 STFT 效果如何。</p>
<p>为了方便可视化，这里给出了对 STFT 变换后的可视化函数。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PlotSTFT</span><span class="params">(T,F,S)</span></span></span><br><span class="line">    <span class="comment">% Plots STFT</span></span><br><span class="line">    plotOpts = struct();</span><br><span class="line">    plotOpts.isFsnormalized = <span class="built_in">false</span>;</span><br><span class="line">    plotOpts.cblbl = getString(message(<span class="string">&#x27;signal:dspdata:dspdata:MagnitudedB&#x27;</span>));</span><br><span class="line">    plotOpts.title = <span class="string">&#x27;Short-time Fourier Transform&#x27;</span>;</span><br><span class="line">    plotOpts.threshold = <span class="built_in">max</span>(<span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(S(:))+<span class="built_in">eps</span>))<span class="number">-60</span>;</span><br><span class="line">    signalwavelet.internal.convenienceplot.plotTFR(T,F,<span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(S)+<span class="built_in">eps</span>),plotOpts);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>注意上面这个函数依赖于 signalwavelet 包，如果没有这个依赖的话，我还提供了一个粗糙版的绘图函数，用法基本类似，不过最后一个参数需要把从窗函数对象传进去：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PlotSTFT_2</span><span class="params">(T, F, S, win)</span></span></span><br><span class="line">    wlen = <span class="built_in">length</span>(win);</span><br><span class="line">    C = sum(win)/wlen;</span><br><span class="line">    S = <span class="built_in">abs</span>(S)/wlen/C;</span><br><span class="line">    </span><br><span class="line">    S = <span class="number">20</span>*<span class="built_in">log10</span>(S + <span class="number">1e-6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">%figure(1)</span></span><br><span class="line">    surf(T, F, S)</span><br><span class="line">    shading interp;</span><br><span class="line">    axis tight;</span><br><span class="line">    view(<span class="number">0</span>, <span class="number">90</span>);</span><br><span class="line">    <span class="comment">%set(gca, &#x27;FontName&#x27;, &#x27;Times New Roman&#x27;, &#x27;FontSize&#x27;, 14);</span></span><br><span class="line">    xlabel(<span class="string">&#x27;Time, s&#x27;</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Frequency, Hz&#x27;</span>);</span><br><span class="line">    title(<span class="string">&#x27;Amplitude spectrogram of the signal&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    hcol = colorbar;</span><br><span class="line">    <span class="comment">%set(hcol, &#x27;FontName&#x27;, &#x27;Times New Roman&#x27;, &#x27;FontSize&#x27;, 14);</span></span><br><span class="line">    ylabel(hcol, <span class="string">&#x27;Magnitude, dB&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>对 Case 1 中的两种情况进行分析，代码如下</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">close all; clear; clc;</span><br><span class="line">fs = <span class="number">1000</span>;</span><br><span class="line">t = <span class="number">0</span>:<span class="number">1</span>/fs:<span class="number">1</span> - <span class="number">1</span>/fs;</span><br><span class="line"><span class="comment">% 窗口大小，推荐取 2 的幂次</span></span><br><span class="line">wlen = <span class="number">256</span>;</span><br><span class="line"><span class="comment">% hop size 即移动步长，一般要取一个小于 wlen 的数，推荐取 2 的幂次</span></span><br><span class="line">hop = wlen/<span class="number">4</span>;</span><br><span class="line"><span class="comment">% FFT 点数，理论上应该不小于wlen，推荐取 2 的幂次</span></span><br><span class="line">nfft = <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">x = [<span class="number">10</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">10</span> * t), <span class="number">20</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">20</span> * t),...</span><br><span class="line">        <span class="number">30</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">30</span> * t), <span class="number">40</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">40</span> * t)];</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"><span class="built_in">plot</span>(x);</span><br><span class="line"><span class="comment">% 随便选的一个窗函数</span></span><br><span class="line">win = blackman(wlen, <span class="string">&#x27;periodic&#x27;</span>);</span><br><span class="line"></span><br><span class="line">[S, f, t] = mystft(x, win, hop, nfft, fs);</span><br><span class="line">subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">PlotSTFT(t,f,S);</span><br><span class="line"></span><br><span class="line">x = x(<span class="keyword">end</span>:<span class="number">-1</span>:<span class="number">1</span>);</span><br><span class="line">subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">plot</span>(x);</span><br><span class="line">win = blackman(wlen, <span class="string">&#x27;periodic&#x27;</span>);</span><br><span class="line"></span><br><span class="line">[S, f, t] = mystft(x, win, hop, nfft, fs);</span><br><span class="line">subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">PlotSTFT(t,f,S);</span><br></pre></td></tr></table></figure>

<p>可以看到，在 FFT 中无法区分的频谱图像在 STFT 中区分就非常明显，可以看出按照不同的时间分段，频谱分布的变化。</p>
<p><img src="/kewenlu2022/images/2022/202204069.png" alt="FFT v.s. STFT"></p>
<p>为了更好地理解，将右上角的图做一次三维旋转：</p>
<p><img src="/kewenlu2022/images/2022/2022040610.png" alt="3d"></p>
<p>可以非常清晰地看出频率分布随时间的变换。注意到分界线处存在异常的高频成分（就是 STFT 图像中那三条竖线），这是因为时域信号突变导致的高频成分。</p>
<h2 id="3-3-Matlab-中的实现"><a href="#3-3-Matlab-中的实现" class="headerlink" title="3.3 Matlab 中的实现"></a>3.3 Matlab 中的实现</h2><p>在老的版本中，Matlab 中 STFT 的函数名为 <code>spectrogram</code>，而在 2019 版本中，引入了新的函数 <code>stft</code>，用法和我上面的实现的程序基本一致。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">close all; clear; clc;</span><br><span class="line">fs = <span class="number">1000</span>;</span><br><span class="line">t = <span class="number">0</span>:<span class="number">1</span>/fs:<span class="number">1</span> - <span class="number">1</span>/fs;</span><br><span class="line"><span class="comment">% 窗口大小，推荐取 2 的幂次</span></span><br><span class="line">wlen = <span class="number">256</span>;</span><br><span class="line"><span class="comment">% hop size 即移动步长，一般要取一个小于 wlen 的数，推荐取 2 的幂次</span></span><br><span class="line">hop = wlen/<span class="number">4</span>;</span><br><span class="line"><span class="comment">% FFT 点数，理论上应该不小于wlen，推荐取 2 的幂次</span></span><br><span class="line">nfft = <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">x = [<span class="number">10</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">10</span> * t), <span class="number">20</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">20</span> * t),...</span><br><span class="line">        <span class="number">30</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">30</span> * t), <span class="number">40</span> * <span class="built_in">cos</span>(<span class="number">2</span> * <span class="built_in">pi</span> * <span class="number">40</span> * t)];</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">subplot(<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>);</span><br><span class="line">win = blackman(wlen, <span class="string">&#x27;periodic&#x27;</span>);</span><br><span class="line">[S, f, t] = mystft(x, win, hop, nfft, fs);</span><br><span class="line">PlotSTFT(t,f,S);</span><br><span class="line">title(<span class="string">&#x27;My STFT&#x27;</span>);</span><br><span class="line"></span><br><span class="line">subplot(<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line">[S1, f1, t1] = spectrogram(x, win, wlen - hop, nfft, fs);</span><br><span class="line">PlotSTFT(t1, f1, S1);</span><br><span class="line">title(<span class="string">&#x27;spectrogram&#x27;</span>);</span><br><span class="line"></span><br><span class="line">subplot(<span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">[S2, f2, t2] = stft(x, fs, <span class="string">&#x27;Window&#x27;</span>, win, <span class="string">&#x27;OverlapLength&#x27;</span>,wlen - hop,<span class="string">&#x27;FFTLength&#x27;</span>,nfft);</span><br><span class="line">PlotSTFT(t2, f2, S2);</span><br><span class="line">title(<span class="string">&#x27;stft&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>需要注意的是，我实现的时候用的参数是 hop size，而 matlab 提供的函数需要的参数是 overlap 这个别搞混了。结果如下。  </p>
<p><img src="/kewenlu2022/images/2022/2022040611.png" alt="result"></p>
<p>要注意的是，spectrogram 输出的是单边谱，而 stft 输出的是双边谱，其他区别倒不大。但是 spectrogram 还可以输出功率谱，而 stft 就不行了。</p>
<h1 id="4-STFT-的缺点"><a href="#4-STFT-的缺点" class="headerlink" title="4. STFT 的缺点"></a>4. STFT 的缺点</h1><p>如果你仔细分析上面的内容，你会发现短时傅立叶变换也有不容忽视的缺陷。</p>
<p>最明显的一个问题：窗口的宽度该设多少为好呢？为了阐明这个问题的影响，我们做这么一个实验：调整不同 <code>wlen</code> 的值，来看看影响。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">len =  [<span class="number">32</span>, <span class="number">64</span>, <span class="number">128</span>, <span class="number">256</span>];</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="number">4</span></span><br><span class="line">    wlen = len(<span class="built_in">i</span>);</span><br><span class="line">    hop = wlen/<span class="number">4</span>;</span><br><span class="line">    nfft = wlen;</span><br><span class="line">    win = blackman(wlen, <span class="string">&#x27;periodic&#x27;</span>);</span><br><span class="line">    [S, f, t] = mystft(x, win, hop, nfft, fs);</span><br><span class="line">    subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="built_in">i</span>);</span><br><span class="line">    PlotSTFT(t,f,S);</span><br><span class="line">    [m, n] = <span class="built_in">size</span>(S);</span><br><span class="line">    t = sprintf(<span class="string">&#x27;Wlen = %d, S: [%d, %d]&#x27;</span>, wlen, m, n);</span><br><span class="line">    title(t);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>结果如下：  </p>
<p><img src="/kewenlu2022/images/2022/2022040612.png" alt="result"></p>
<p>注意 <code>S</code> 的尺寸随 <code>wlen</code> 的变换，不难发现一个事实：</p>
<ul>
<li><strong>窗太窄，窗内的信号太短，会导致频率分析不够精准，频率分辨率差</strong>，具体表现是黄色的横线越来越宽、越来越模糊</li>
<li><strong>窗太宽，时域上又不够精细，时间分辨率低</strong>，具体表现是淡蓝色的竖线越来越宽、越来越模糊（还记得吗，竖线表示交界处的突变造成的高频干扰成分）</li>
</ul>
<p>从定量的角度来看，STFT 的时间分辨率取决于滑移宽度 $H$，而频率分辨率则取决于 $\frac{F_s}{H}$。显然，一方的增加必然意味着另一方的减小。这就是所谓的时频测不准原理（跟海森堡测不准是一个性质），具体关系为：</p>
<p>$$<br>\Delta t \cdot \Delta f \geqslant \frac{1}{4\pi} $$</p>
<p><img src="/kewenlu2022/images/2022/2022040613.png" alt="window size"></p>
<p>另外，固定的窗口大小过于死板。对低频信号而言，有可能连一个周期都不能覆盖；对高频信号而言，可能覆盖过多周期，不能反映信号变化。</p>
<p>也就是说，这又是一个 Trade-Off 问题，而一个问题一旦进入 Trade-Off 模式，就开始变得玄学起来了。</p>
<p>为了打破这种玄学困境，就需要一个更加强大的武器——小波变换。</p>
<p>至于小波变换，那就是另一个故事了。</p>
<p><strong>都看到这儿了，不如关注每日推送的“科文路”、互动起来~</strong></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>时频分析——短时傅里叶变换STFT</p><p><a href="https://xlindo.com/kewenlu2022/posts/64460339/">https://xlindo.com/kewenlu2022/posts/64460339/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>xlindo</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-04-06</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-05-10</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/kewenlu2022/tags/%E7%A7%91%E6%8A%80/">科技</a><a class="link-muted mr-2" rel="tag" href="/kewenlu2022/tags/%E5%A4%87%E6%9F%A5%E6%89%8B%E5%86%8C/">备查手册</a><a class="link-muted mr-2" rel="tag" href="/kewenlu2022/tags/%E6%97%B6%E9%A2%91%E5%88%86%E6%9E%90/">时频分析</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/kewenlu2022/posts/4fb95770/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">2022值得关注的体育赛事</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/kewenlu2022/posts/5274d679/"><span class="level-item">荐影：寻梦环游记Coco</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="SOHUCS" sid="posts/64460339/"></div><script charset="utf-8" src="https://changyan.sohu.com/upload/changyan.js"></script><script>window.changyan.api.config({appid: 'cyvmJmMgc',conf: 'e37a55ecf6df7ba6217b8997f4dcd9ab'});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/kewenlu2022/images/avatar-512x512.png" alt="科文路"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">科文路</p><p class="is-size-6 is-block">微信公众号&quot;科文路&quot;2022年文章存档</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/kewenlu2022/archives"><p class="title">380</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/kewenlu2022/categories"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/kewenlu2022/tags"><p class="title">71</p></a></div></div></nav></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#1-引言"><span class="level-left"><span class="level-item">1</span><span class="level-item">1. 引言</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Case-1"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Case 1</span></span></a></li><li><a class="level is-mobile" href="#Case-2"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">Case 2</span></span></a></li><li><a class="level is-mobile" href="#为什么我们需要时频分析"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">为什么我们需要时频分析</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-短时傅里叶变换原理"><span class="level-left"><span class="level-item">2</span><span class="level-item">2. 短时傅里叶变换原理</span></span></a></li><li><a class="level is-mobile" href="#3-STFT-实现"><span class="level-left"><span class="level-item">3</span><span class="level-item">3. STFT 实现</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-1-算法实现"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">3.1 算法实现</span></span></a></li><li><a class="level is-mobile" href="#3-2-使用范例"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">3.2 使用范例</span></span></a></li><li><a class="level is-mobile" href="#3-3-Matlab-中的实现"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">3.3 Matlab 中的实现</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-STFT-的缺点"><span class="level-left"><span class="level-item">4</span><span class="level-item">4. STFT 的缺点</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/kewenlu2022/js/toc.js" defer></script></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://xlindo.com/kewenlu" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">kewenlu@today</span></span><span class="level-right"><span class="level-item tag">xlindo.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/kewenlu2022/categories/%E4%BA%BA%E6%96%87/"><span class="level-start"><span class="level-item">人文</span></span><span class="level-end"><span class="level-item tag">248</span></span></a></li><li><a class="level is-mobile" href="/kewenlu2022/categories/%E7%A7%91%E6%8A%80/"><span class="level-start"><span class="level-item">科技</span></span><span class="level-end"><span class="level-item tag">123</span></span></a></li><li><a class="level is-mobile" href="/kewenlu2022/categories/%E7%A7%91%E6%96%87%E8%B7%AF/"><span class="level-start"><span class="level-item">科文路</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2099-12-31T13:39:14.000Z">2099-12-31</time></p><p class="title"><a href="/kewenlu2022/posts/6a425fbd/">再见，2022：“科文路”年度简报</a></p><p class="categories"><a href="/kewenlu2022/categories/%E7%A7%91%E6%96%87%E8%B7%AF/">科文路</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-02-21T12:01:10.000Z">2023-02-21</time></p><p class="title"><a href="/kewenlu2022/posts/41f3354d/">省馆之宝：合集</a></p><p class="categories"><a href="/kewenlu2022/categories/%E4%BA%BA%E6%96%87/">人文</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-02-16T12:39:42.000Z">2023-02-16</time></p><p class="title"><a href="/kewenlu2022/posts/65410c85/">LLVM：测试基础（一），llvm-lit、FileCheck</a></p><p class="categories"><a href="/kewenlu2022/categories/%E7%A7%91%E6%8A%80/">科技</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-02-14T11:06:03.000Z">2023-02-14</time></p><p class="title"><a href="/kewenlu2022/posts/6e513fcf/">省馆之宝：广东，不辞长作岭南人</a></p><p class="categories"><a href="/kewenlu2022/categories/%E4%BA%BA%E6%96%87/">人文</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-02-07T15:27:51.000Z">2023-02-07</time></p><p class="title"><a href="/kewenlu2022/posts/b332288e/">省馆之宝：西藏，世界屋脊</a></p><p class="categories"><a href="/kewenlu2022/categories/%E4%BA%BA%E6%96%87/">人文</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/kewenlu2022/archives/2099/"><span class="level-start"><span class="level-item">2099</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/kewenlu2022/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/kewenlu2022/archives/2022/"><span class="level-start"><span class="level-item">2022</span></span><span class="level-end"><span class="level-item tag">352</span></span></a></li><li><a class="level is-mobile" href="/kewenlu2022/archives/2021/"><span class="level-start"><span class="level-item">2021</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/AI/"><span class="tag">AI</span><span class="tag">32</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/C/"><span class="tag">C++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/GPGPU/"><span class="tag">GPGPU</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/IC/"><span class="tag">IC</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/LLVM/"><span class="tag">LLVM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/MLIR/"><span class="tag">MLIR</span><span class="tag">19</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/MobileNets/"><span class="tag">MobileNets</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/RISC-V/"><span class="tag">RISC-V</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E4%B8%80%E5%91%A8%E9%80%9F%E8%A7%88/"><span class="tag">一周速览</span><span class="tag">25</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E4%B8%96%E7%95%8C%E6%9D%AF/"><span class="tag">世界杯</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"><span class="tag">人工智能</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E4%BA%BA%E6%96%87/"><span class="tag">人文</span><span class="tag">250</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E4%BD%93%E8%82%B2/"><span class="tag">体育</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%81%A5%E5%BA%B7/"><span class="tag">健康</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%8A%A0%E9%80%9F/"><span class="tag">加速</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%8D%9A%E7%89%A9/"><span class="tag">博物</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%8E%86%E5%8F%B2/"><span class="tag">历史</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%90%8D%E4%BD%9C/"><span class="tag">名作</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%9B%BE%E7%81%B5%E5%A5%96/"><span class="tag">图灵奖</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%A4%87%E6%9F%A5%E6%89%8B%E5%86%8C/"><span class="tag">备查手册</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%A4%A9%E6%96%87/"><span class="tag">天文</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%AD%A6%E4%B9%A0/"><span class="tag">学习</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%B0%AC%E8%81%8A/"><span class="tag">尬聊</span><span class="tag">12</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%B1%95%E8%A7%88/"><span class="tag">展览</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%B7%A5%E4%BD%9C/"><span class="tag">工作</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%B7%A5%E5%85%B7/"><span class="tag">工具</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%B9%B4%E5%BA%A6/"><span class="tag">年度</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E5%BC%80%E6%BA%90/"><span class="tag">开源</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%8A%A5%E5%91%8A/"><span class="tag">报告</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%8E%A7%E5%88%B6/"><span class="tag">控制</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%95%99%E8%82%B2/"><span class="tag">教育</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%95%B0%E5%AD%A6/"><span class="tag">数学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%95%B0%E5%AD%A6%E4%B8%8E%E7%BB%9F%E8%AE%A1/"><span class="tag">数学与统计</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%95%B0%E7%A0%81/"><span class="tag">数码</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%96%87%E5%AD%A6/"><span class="tag">文学</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%96%87%E7%89%A9/"><span class="tag">文物</span><span class="tag">29</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%97%85%E6%B8%B8/"><span class="tag">旅游</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%97%B6%E4%BA%8B/"><span class="tag">时事</span><span class="tag">74</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%88%86%E6%9E%90/"><span class="tag">时间序列分析</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%97%B6%E9%A2%91%E5%88%86%E6%9E%90/"><span class="tag">时频分析</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%98%8E%E6%98%9F/"><span class="tag">明星</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E6%B2%A1%E7%94%A8%E7%99%BE%E7%A7%91/"><span class="tag">没用百科</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%94%9F%E6%B4%BB/"><span class="tag">生活</span><span class="tag">15</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%94%B5%E5%BD%B1/"><span class="tag">电影</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%99%BE%E7%A7%91/"><span class="tag">百科</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%9C%81%E9%A6%86%E4%B9%8B%E5%AE%9D/"><span class="tag">省馆之宝</span><span class="tag">29</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%9F%A5%E4%B9%8E/"><span class="tag">知乎</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%A7%91%E6%8A%80/"><span class="tag">科技</span><span class="tag">124</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%A7%91%E6%96%87%E8%B7%AF/"><span class="tag">科文路</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%A7%91%E6%99%AE/"><span class="tag">科普</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"><span class="tag">程序设计</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%B2%97%E7%95%A5%E4%BC%B0%E7%AE%97%E6%8A%80%E5%B7%A7/"><span class="tag">粗略估算技巧</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%BB%8F%E9%AA%8C/"><span class="tag">经验</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%BB%BC%E8%89%BA/"><span class="tag">综艺</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%BC%96%E7%A8%8B/"><span class="tag">编程</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"><span class="tag">编译原理</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E7%BC%96%E8%AF%91%E5%99%A8/"><span class="tag">编译器</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%82%A1%E5%B8%82/"><span class="tag">股市</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%87%AA%E5%8A%A8%E9%A9%BE%E9%A9%B6/"><span class="tag">自动驾驶</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%89%BA%E6%9C%AF/"><span class="tag">艺术</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%8D%90%E6%96%87/"><span class="tag">荐文</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%8D%90%E6%AD%8C/"><span class="tag">荐歌</span><span class="tag">41</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%A2%AB%E6%9F%A5%E6%89%8B%E5%86%8C/"><span class="tag">被查手册</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%A7%86%E8%A7%92/"><span class="tag">视角</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/"><span class="tag">计算机</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E4%B8%8E%E8%AE%BE%E8%AE%A1/"><span class="tag">计算机组成与设计</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%AF%AD%E6%96%87/"><span class="tag">语文</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E8%BF%90%E5%8A%A8/"><span class="tag">运动</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E9%80%9B%E7%9F%A5%E4%B9%8E/"><span class="tag">逛知乎</span><span class="tag">26</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E9%97%B2%E8%81%8A/"><span class="tag">闲聊</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/kewenlu2022/tags/%E9%9F%B3%E4%B9%90/"><span class="tag">音乐</span><span class="tag">6</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/kewenlu2022/"><img src="/kewenlu2022/images/favicon.ico" alt="科文路" height="28"></a><p class="is-size-7"><span>&copy; 2024 xlindo</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/kewenlu2022/js/column.js"></script><script src="/kewenlu2022/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/kewenlu2022/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/kewenlu2022/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/kewenlu2022/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/kewenlu2022/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>